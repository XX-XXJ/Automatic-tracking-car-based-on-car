C51 COMPILER V9.57.0.0   PID                                                               06/30/2025 14:48:52 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE PID
OBJECT MODULE PLACED IN .\Objects\PID.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE PID.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\PID.l
                    -st) TABS(2) OBJECT(.\Objects\PID.obj)

line level    source

   1          #include "PID.h"
   2          
   3          float Kp = 0, Ki = 0, Kd = 0;
   4          float integral = 0;
   5          float prev_error = 0;
   6          float p,i,d;
   7          
   8          void PID_Init(float kp, float ki, float kd)
   9          {
  10   1          Kp = kp;
  11   1          Ki = ki;
  12   1          Kd = kd;
  13   1          PID_Reset();
  14   1      }
  15          
  16          void PID_Reset(void)
  17          {
  18   1          integral = 0;
  19   1          prev_error = 0;
  20   1      }
  21          
  22          float PID_Compute(float error)
  23          {
  24   1          p = Kp * error;
  25   1          i = Ki * integral;
  26   1          d = Kd * (error - prev_error);
  27   1      //old
  28   1      //    if(integral > 50)  integral = 50;  // 积分限幅
  29   1      //    if(integral < -50) integral = -50;
  30   1      //new
  31   1          if(i>10) i = 10; //积分限幅
  32   1      
  33   1          prev_error = error;
  34   1          integral += error;
  35   1          return p + i + d;
  36   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    247    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     32      16
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
